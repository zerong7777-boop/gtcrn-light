
!!!!!!!!!!!!!!!最终版本为gtrcn_light_v3.py

# 训练
python train_my_spec_light_v3.py -C configs/cfg_train_gtcrn_spec.yaml -D 0

# 1) 批量推理（频谱版）
python tools/batch_infer_gtcrn_spec_light.py \
  --ckpt /home/jgzn/PycharmProjects/RZ/danzi/audio/SEtrain/exp_gtcrn_spec_vbd_2025-11-11-13h25m/checkpoints/best_model_078.tar \
  --in_dir  ../data/test/noisy \
  --out_dir ../SEtrain/outs/gtcrn_spec_test_light3 \
  --sr 16000 --n_fft 512 --hop 256 --win 512 --device cuda

# 2) 生成配对清单（enh ↔ clean）
python tools/make_pairs_from_outputs.py \
  --enh_dir  ../SEtrain/outs/gtcrn_spec_test_light3 \
  --clean_dir ../data/test/clean \
  --out_scp ../SEtrain/outs/test_enh_vs_clean_light3.scp

# 3) 计算指标
python tools/eval_metrics.py \
  --pairs ../SEtrain/outs/test_enh_vs_clean_light3.scp \
  --sr 16000 --mode wb --estoi

# 结果：
=== Metrics (mean over pairs) ===
PESQ (wb): 2.5966
STOI:             0.9338
ESTOI:            0.8299
SI-SNR (dB):      17.8915






# 测评参数量：
使用前将gtrcn_light_v3.py中GTCRN_light_v3类名暂时改为GTCRN_light_v3
python tools/print_model_stats.py --mode spec --arch gtrcn_light_v3   --lightv3-file models/gtrcn_light_v3.py   --width-mult 1.0 --two-rnn --rnn-bidir


# 结果：
=== GTCRN-Light v3 (Spec Core) ===
Config  : width_mult=1.0, use_two_dpgrnn=True, rnn_bidirectional=True
Loaded  : file='models/gtrcn_light_v3.py', class='GTCRN_light'
Input(1s): F=257, T=63  (n_fft=512, hop=256, win=512)
Para. (M):  0.008
MACs (G/s): 0.017  # 核心网络，不含 STFT/ISTFT